[2023-10-17 06:00:58,143] ERROR [Controller id=2 epoch=1] Controller 2 epoch 1 failed to change state for partition TEST-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition TEST-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:130)
[2023-10-17 06:00:58,146] INFO [Controller id=2 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:00:58,149] INFO [Controller id=2 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:01:03,205] ERROR [Controller id=2 epoch=1] Controller 2 epoch 1 failed to change state for partition TEST-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition TEST-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:130)
[2023-10-17 06:01:03,206] INFO [Controller id=2 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:01:03,208] INFO [Controller id=2 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:01:08,257] ERROR [Controller id=2 epoch=1] Controller 2 epoch 1 failed to change state for partition TEST-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition TEST-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:130)
[2023-10-17 06:01:08,258] INFO [Controller id=2 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:01:08,260] INFO [Controller id=2 epoch=1] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:02:59,367] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers Set(2) for 0 partitions (state.change.logger)
[2023-10-17 06:02:59,634] INFO [Controller id=2 epoch=2] Sending LeaderAndIsr request to broker 2 with 51 become-leader and 0 become-follower partitions (state.change.logger)
[2023-10-17 06:02:59,647] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers Set(2) for 51 partitions (state.change.logger)
[2023-10-17 06:02:59,712] INFO [Controller id=2 epoch=2] Partition TEST-0 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-10-17 06:02:59,723] INFO [Controller id=2 epoch=2] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-10-17 06:02:59,725] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers Set(2) for 1 partitions (state.change.logger)
[2023-10-17 06:03:00,119] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 51 partitions (state.change.logger)
[2023-10-17 06:03:00,574] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 2 epoch 2 as part of the become-leader transition for 51 partitions (state.change.logger)
[2023-10-17 06:03:00,638] INFO [Broker id=2] Leader __consumer_offsets-0 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,723] INFO [Broker id=2] Leader __consumer_offsets-29 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,767] INFO [Broker id=2] Leader __consumer_offsets-48 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,792] INFO [Broker id=2] Leader __consumer_offsets-10 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,815] INFO [Broker id=2] Leader __consumer_offsets-45 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,841] INFO [Broker id=2] Leader TEST-0 with topic id Some(qFnR-VVCTm-X0fURLNnycA) starts at leader epoch 0 from offset 5 with partition epoch 1, high watermark 5, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,850] INFO [Broker id=2] Leader __consumer_offsets-26 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,873] INFO [Broker id=2] Leader __consumer_offsets-7 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,905] INFO [Broker id=2] Leader __consumer_offsets-42 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,936] INFO [Broker id=2] Leader __consumer_offsets-4 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,968] INFO [Broker id=2] Leader __consumer_offsets-23 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:00,999] INFO [Broker id=2] Leader __consumer_offsets-1 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,061] INFO [Broker id=2] Leader __consumer_offsets-20 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,096] INFO [Broker id=2] Leader __consumer_offsets-39 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,132] INFO [Broker id=2] Leader __consumer_offsets-17 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,163] INFO [Broker id=2] Leader __consumer_offsets-36 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,197] INFO [Broker id=2] Leader __consumer_offsets-14 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,229] INFO [Broker id=2] Leader __consumer_offsets-33 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,261] INFO [Broker id=2] Leader __consumer_offsets-49 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,296] INFO [Broker id=2] Leader __consumer_offsets-11 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,330] INFO [Broker id=2] Leader __consumer_offsets-30 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,364] INFO [Broker id=2] Leader __consumer_offsets-46 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,398] INFO [Broker id=2] Leader __consumer_offsets-27 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,434] INFO [Broker id=2] Leader __consumer_offsets-8 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,484] INFO [Broker id=2] Leader __consumer_offsets-24 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,505] INFO [Broker id=2] Leader __consumer_offsets-43 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,524] INFO [Broker id=2] Leader __consumer_offsets-5 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,547] INFO [Broker id=2] Leader __consumer_offsets-21 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,570] INFO [Broker id=2] Leader __consumer_offsets-40 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,590] INFO [Broker id=2] Leader __consumer_offsets-2 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,609] INFO [Broker id=2] Leader __consumer_offsets-37 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,628] INFO [Broker id=2] Leader __consumer_offsets-18 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,643] INFO [Broker id=2] Leader __consumer_offsets-34 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,663] INFO [Broker id=2] Leader __consumer_offsets-15 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,682] INFO [Broker id=2] Leader __consumer_offsets-12 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,700] INFO [Broker id=2] Leader __consumer_offsets-31 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,721] INFO [Broker id=2] Leader __consumer_offsets-9 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,739] INFO [Broker id=2] Leader __consumer_offsets-47 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,762] INFO [Broker id=2] Leader __consumer_offsets-19 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,782] INFO [Broker id=2] Leader __consumer_offsets-28 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,802] INFO [Broker id=2] Leader __consumer_offsets-38 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,825] INFO [Broker id=2] Leader __consumer_offsets-35 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,859] INFO [Broker id=2] Leader __consumer_offsets-6 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,880] INFO [Broker id=2] Leader __consumer_offsets-44 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,904] INFO [Broker id=2] Leader __consumer_offsets-25 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,930] INFO [Broker id=2] Leader __consumer_offsets-16 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,954] INFO [Broker id=2] Leader __consumer_offsets-22 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,977] INFO [Broker id=2] Leader __consumer_offsets-41 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:01,999] INFO [Broker id=2] Leader __consumer_offsets-32 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:02,017] INFO [Broker id=2] Leader __consumer_offsets-3 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:02,038] INFO [Broker id=2] Leader __consumer_offsets-13 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:03:02,173] INFO [Broker id=2] Finished LeaderAndIsr request in 2060ms correlationId 1 from controller 2 for 51 partitions (state.change.logger)
[2023-10-17 06:03:02,227] INFO [Broker id=2] Add 51 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 2 with correlation id 2 (state.change.logger)
[2023-10-17 06:03:02,233] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 2 for 1 partitions (state.change.logger)
[2023-10-17 06:03:02,238] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 2 for partition TEST-0 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2023-10-17 06:03:02,241] INFO [Broker id=2] Finished LeaderAndIsr request in 7ms correlationId 3 from controller 2 for 1 partitions (state.change.logger)
[2023-10-17 06:03:02,248] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 2 with correlation id 4 (state.change.logger)
[2023-10-17 06:05:23,162] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition TEST-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition TEST-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:130)
[2023-10-17 06:05:23,165] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:05:23,167] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:05:28,206] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition TEST-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition TEST-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:130)
[2023-10-17 06:05:28,207] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:05:28,207] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:05:33,251] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition TEST-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition TEST-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:213)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:130)
[2023-10-17 06:05:33,254] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:05:33,256] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers Set() for 0 partitions (state.change.logger)
[2023-10-17 06:05:49,061] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers Set(2) for 0 partitions (state.change.logger)
[2023-10-17 06:05:49,460] INFO [Controller id=2 epoch=3] Sending LeaderAndIsr request to broker 2 with 51 become-leader and 0 become-follower partitions (state.change.logger)
[2023-10-17 06:05:49,489] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers Set(2) for 51 partitions (state.change.logger)
[2023-10-17 06:05:49,601] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 51 partitions (state.change.logger)
[2023-10-17 06:05:49,614] INFO [Controller id=2 epoch=3] Partition TEST-0 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:0,ZkVersion:1,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2023-10-17 06:05:49,625] INFO [Controller id=2 epoch=3] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2023-10-17 06:05:49,626] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers Set(2) for 1 partitions (state.change.logger)
[2023-10-17 06:05:50,065] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 2 epoch 3 as part of the become-leader transition for 51 partitions (state.change.logger)
[2023-10-17 06:05:50,149] INFO [Broker id=2] Leader __consumer_offsets-0 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,185] INFO [Broker id=2] Leader __consumer_offsets-29 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,209] INFO [Broker id=2] Leader __consumer_offsets-48 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,232] INFO [Broker id=2] Leader __consumer_offsets-10 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,253] INFO [Broker id=2] Leader __consumer_offsets-45 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,317] INFO [Broker id=2] Leader TEST-0 with topic id Some(qFnR-VVCTm-X0fURLNnycA) starts at leader epoch 0 from offset 5 with partition epoch 1, high watermark 5, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,326] INFO [Broker id=2] Leader __consumer_offsets-26 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,342] INFO [Broker id=2] Leader __consumer_offsets-7 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,366] INFO [Broker id=2] Leader __consumer_offsets-42 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,387] INFO [Broker id=2] Leader __consumer_offsets-4 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,409] INFO [Broker id=2] Leader __consumer_offsets-23 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,431] INFO [Broker id=2] Leader __consumer_offsets-1 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,453] INFO [Broker id=2] Leader __consumer_offsets-20 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,472] INFO [Broker id=2] Leader __consumer_offsets-39 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,540] INFO [Broker id=2] Leader __consumer_offsets-17 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,558] INFO [Broker id=2] Leader __consumer_offsets-36 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,576] INFO [Broker id=2] Leader __consumer_offsets-14 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,596] INFO [Broker id=2] Leader __consumer_offsets-33 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,614] INFO [Broker id=2] Leader __consumer_offsets-49 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,632] INFO [Broker id=2] Leader __consumer_offsets-11 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,653] INFO [Broker id=2] Leader __consumer_offsets-30 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,672] INFO [Broker id=2] Leader __consumer_offsets-46 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,695] INFO [Broker id=2] Leader __consumer_offsets-27 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,715] INFO [Broker id=2] Leader __consumer_offsets-8 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,734] INFO [Broker id=2] Leader __consumer_offsets-24 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,753] INFO [Broker id=2] Leader __consumer_offsets-43 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,771] INFO [Broker id=2] Leader __consumer_offsets-5 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,791] INFO [Broker id=2] Leader __consumer_offsets-21 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,812] INFO [Broker id=2] Leader __consumer_offsets-40 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,831] INFO [Broker id=2] Leader __consumer_offsets-2 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,851] INFO [Broker id=2] Leader __consumer_offsets-37 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,870] INFO [Broker id=2] Leader __consumer_offsets-18 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,889] INFO [Broker id=2] Leader __consumer_offsets-34 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,908] INFO [Broker id=2] Leader __consumer_offsets-15 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,926] INFO [Broker id=2] Leader __consumer_offsets-12 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,946] INFO [Broker id=2] Leader __consumer_offsets-31 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,967] INFO [Broker id=2] Leader __consumer_offsets-9 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:50,988] INFO [Broker id=2] Leader __consumer_offsets-47 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,007] INFO [Broker id=2] Leader __consumer_offsets-19 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,042] INFO [Broker id=2] Leader __consumer_offsets-28 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,064] INFO [Broker id=2] Leader __consumer_offsets-38 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,088] INFO [Broker id=2] Leader __consumer_offsets-35 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,111] INFO [Broker id=2] Leader __consumer_offsets-6 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,133] INFO [Broker id=2] Leader __consumer_offsets-44 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,154] INFO [Broker id=2] Leader __consumer_offsets-25 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,175] INFO [Broker id=2] Leader __consumer_offsets-16 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,191] INFO [Broker id=2] Leader __consumer_offsets-22 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,213] INFO [Broker id=2] Leader __consumer_offsets-41 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,237] INFO [Broker id=2] Leader __consumer_offsets-32 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,260] INFO [Broker id=2] Leader __consumer_offsets-3 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,283] INFO [Broker id=2] Leader __consumer_offsets-13 with topic id Some(j0hml4uIS4WRSr2Vl5d3kg) starts at leader epoch 0 from offset 0 with partition epoch 0, high watermark 0, ISR [2], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2023-10-17 06:05:51,447] INFO [Broker id=2] Finished LeaderAndIsr request in 1856ms correlationId 1 from controller 2 for 51 partitions (state.change.logger)
[2023-10-17 06:05:51,557] INFO [Broker id=2] Add 51 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 2 (state.change.logger)
[2023-10-17 06:05:51,573] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 2 for 1 partitions (state.change.logger)
[2023-10-17 06:05:51,579] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 3 for partition TEST-0 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2023-10-17 06:05:51,582] INFO [Broker id=2] Finished LeaderAndIsr request in 9ms correlationId 3 from controller 2 for 1 partitions (state.change.logger)
[2023-10-17 06:05:51,596] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 4 (state.change.logger)
